% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DOST.R
\name{DOST}
\alias{DOST}
\title{DOST: Distance-preserving Optimization for Spatial Transcriptomics}
\usage{
DOST(
  X,
  coords,
  R,
  selected_genes = "HVG",
  nGenes = 3000,
  neighborhood_threshold = 1,
  embedding_dim = 20,
  lambda = 0.025,
  lr = 16,
  max_iterations = 20,
  refinement = TRUE,
  refine_k = 30
)
}
\arguments{
\item{X}{A sparse matrix or matrix of gene expression counts (Genes x Spots).}

\item{coords}{A data frame or matrix of spatial coordinates (Spots x 2).
Rows of \code{coords} must match the columns of \code{X}.}

\item{R}{Integer. The number of clusters (domains) to identify.}

\item{selected_genes}{Character. Gene selection method: \code{"HVG"} (default), \code{"SVG"}, or \code{"all"}.}

\item{nGenes}{Integer. Number of genes to use if selection is enabled. Default is 3000.}

\item{neighborhood_threshold}{Spatial adjacency threshold multiplier. Default is 1.}

\item{embedding_dim}{Dimension of the initial embedding. Default is 20.}

\item{lambda}{Regularization weight for spatial coherence. Default is 0.03.}

\item{lr}{Optimization learning rate. Default is 16.}

\item{max_iterations}{Max optimization steps. Default is 20.}

\item{refinement}{Logical. Whether to smooth the final labels using spatial neighbors.
Recommended for tissues with laminar structures (e.g., DLPFC, mPFC). Default is \code{TRUE}.}

\item{refine_k}{Number of neighbors for label refinement. Default is 30.}
}
\value{
A list containing:
\itemize{
\item \code{Z}: The low-dimensional embedding matrix.
\item \code{labels}: The final cluster labels.
\item \code{losses}: The loss function history.
}
}
\description{
Runs DOST to identify spatial domains in spatial transcriptomics data.
}
\details{
\strong{Recommended Settings by Technology:}

The default parameters are optimized for \strong{10x Visium} data. For other technologies,
we recommend the following adjustments based on our benchmarks:

\itemize{
\item \strong{10x Visium:}
\itemize{
\item \code{embedding_dim = 20}
\item \code{neighborhood_threshold = 1}
\item \code{lambda = 0.03}
\item \code{nGenes = 3000} (HVG or SVG)
}
\item \strong{MERFISH:}
\itemize{
\item \code{embedding_dim = 10}
\item \code{neighborhood_threshold = 3} (Due to higher spatial resolution)
\item \code{lambda = 0.2}
\item \code{selected_genes = "all"} (If gene count is low)
}
\item \strong{STARmap:}
\itemize{
\item \code{embedding_dim = 10}
\item \code{neighborhood_threshold = 1}
\item \code{lambda = 0.15}
\item \code{selected_genes = "all"}
}
}

\strong{Refinement Note:}
The optional refinement step (\code{refinement = TRUE}) effectively smooths boundaries
and is highly recommended for tissues with known laminar or layered structures
(e.g., Cortex). For tissues with discrete, punctate domains, you may wish to
set this to \code{FALSE}.
}
