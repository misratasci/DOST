[{"path":"/articles/DLPFC.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"vignette demonstrates reproduce DLPFC results presented article using DOST package. ensure results match manuscript exactly, use specific version DLPFC dataset provided Benchmark ST Reproducibility study.","code":""},{"path":"/articles/DLPFC.html","id":"data-preparation","dir":"Articles","previous_headings":"","what":"1. Data Preparation","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"Please follow steps prepare data: Go Zenodo Repository download DLPFC12.zip file. Unzip file. Note path parent folder called “DLPFC12”. refer dir.input code .","code":""},{"path":"/articles/DLPFC.html","id":"define-helper-functions","dir":"Articles","previous_headings":"","what":"2. Define Helper Functions","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"use custom loader function parse specific directory structure benchmark dataset attach ground truth layer annotations (L1-L6, WM) Seurat object.","code":"library(DOST) library(Seurat) library(ggplot2)  # Custom loader for the Benchmark ST Reproducibility dataset structure load_DLPFC_sample <- function(slice.id, dir.input) {   filename <- paste0(slice.id, \"_filtered_feature_bc_matrix.h5\")   data.dir <- file.path(dir.input, slice.id)      if (!dir.exists(data.dir)) {     stop(paste(\"Directory not found:\", data.dir))   }    sp_data <- Seurat::Load10X_Spatial(data.dir, filename = filename, filter.matrix = FALSE)      # Add the annotations    gt_file <- file.path(data.dir, 'gt', 'tissue_positions_list_GTs.txt')   if (!file.exists(gt_file)) {     stop(\"Ground truth file missing. Ensure you downloaded the full benchmark zip.\")   }    df_meta <- read.table(gt_file, sep = \",\", row.names = 1)   common_cells <- colnames(sp_data[[\"Spatial\"]]) %in% rownames(df_meta)   sp_data <- sp_data[, common_cells]      layer.data <- data.frame()   layers <- c('L1', 'L2', 'L3', 'L4', 'L5', 'L6', 'WM')      for (l in layers) {     filename <- paste0(slice.id, \"_\", l, \"_barcodes.txt\")     filename <- file.path(data.dir, 'gt', 'layered', filename)     if (!file.exists(filename)) next     data.temp <- read.table(filename)     data.temp <- data.frame(barcode = data.temp[,1], layer = l, row.names = data.temp[,1])     layer.data <- rbind(layer.data, data.temp)   }      sp_data <- SeuratObject::AddMetaData(sp_data, metadata = df_meta['V3'], col.name = 'row')    sp_data <- SeuratObject::AddMetaData(sp_data, metadata = df_meta['V4'], col.name = 'col')   sp_data <- SeuratObject::AddMetaData(sp_data, metadata = layer.data['layer'], col.name = 'layers')      return(sp_data) }"},{"path":"/articles/DLPFC.html","id":"load-data","dir":"Articles","previous_headings":"","what":"3. Load Data","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"Now load sample 151673. Note: code , replace \"path//DLPFC12\" actual path unzipped data.","code":"# Set this to the folder where you unzipped DLPFC12.zip # e.g., \"~/Downloads/DLPFC12\" dir.input <- \"path/to/DLPFC12\"  slice_id <- \"151673\"  # Load the sample using the helper function sample <- load_DLPFC_sample(slice_id, dir.input)  # Extract inputs for DOST X <- Seurat::GetAssayData(sample, layer = \"counts\") coords <- Seurat::GetTissueCoordinates(sample, scale = 'hires')[1:2]  # Extract the ground truth labels gt <- sample@meta.data$layers"},{"path":"/articles/DLPFC.html","id":"run-dost","dir":"Articles","previous_headings":"","what":"4. Run DOST","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"run DOST algorithm using recommended settings 10x Visium data: R = 7: DLPFC structure known layers L1-L6 plus White Matter (WM). lambda = 0.03: recommended regularization weight Visium. refinement = TRUE: Recommended laminar tissues like cortex.","code":"results <- DOST(   X = X,    coords = coords,    R = 7,    lambda = 0.03,    refinement = TRUE )"},{"path":"/articles/DLPFC.html","id":"visualization","dir":"Articles","previous_headings":"","what":"5. Visualization","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"can visualize resulting spatial domains UMAP representation low dimensional DOST embedding.","code":"# Visualize Spatial Domains sample@meta.data[[\"DOST\"]] <- results$labels p1 <- Seurat::SpatialDimPlot(sample, group.by = \"DOST\", pt.size.factor = 2.5) +   Seurat::NoLegend() print(p1) # Visualize UMAP with ground truth labels p2 <- plot_DOST_umap(   Z = results$Z,    labels = gt ) print(p2)"},{"path":"/articles/DLPFC.html","id":"validation-ari","dir":"Articles","previous_headings":"","what":"6. Validation (ARI)","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"Since ground truth annotations dataset, can easily calculate Adjusted Rand Index (ARI) quantify performance. Adjusted Rand Index (ARI): 0.597","code":"ari_score <- mclust::adjustedRandIndex(results$labels, gt)  cat(paste(\"Adjusted Rand Index (ARI):\", round(ari_score, 3)))"},{"path":"/articles/DLPFC.html","id":"diagnostics","dir":"Articles","previous_headings":"","what":"7. Diagnostics","title":"Reproducing Spatial Domain Identification of DLPFC with DOST","text":"Finally, good practice inspect optimization history ensure algorithm converged. losses element results list tracks objective function value iteration.","code":"# Create a sequence for iterations starting at 0 iterations <- 0:(length(results$losses) - 1)  # Plot the optimization loss plot(iterations, results$losses, type = \"b\", pch = 19, col = \"blue\",      xlab = \"Iteration\", ylab = \"Loss\",      main = \"DOST Optimization Convergence\") grid()"},{"path":"/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Mehmet Gönen. Author, maintainer.","code":""},{"path":"/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Gönen M (2025). DOST: Distance-preserving Optimiaztion Spatial Transcriptomics. R package version 0.0.0.9000, https://github.com/misratasci/DOST.","code":"@Manual{,   title = {DOST: Distance-preserving Optimiaztion for Spatial Transcriptomics},   author = {Mehmet Gönen},   year = {2025},   note = {R package version 0.0.0.9000},   url = {https://github.com/misratasci/DOST}, }"},{"path":"/index.html","id":"dost-distance-preserving-optimization-for-spatial-transcriptomics","dir":"","previous_headings":"","what":"Distance-preserving Optimiaztion for Spatial Transcriptomics","title":"Distance-preserving Optimiaztion for Spatial Transcriptomics","text":"DOST R package identifying spatial domains spatial transcriptomics (ST) data. distance-preserving optimization based method clusters ST spots spatial domains. DOST embeds ST spots low-dimensional space using Sammon mapping inspired loss function jointly preserves gene expression similarity spatial smoothness.","code":""},{"path":"/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Distance-preserving Optimiaztion for Spatial Transcriptomics","text":"can install development version DOST GitHub :","code":"# install.packages(\"devtools\") devtools::install_github(\"misratasci/DOST\")"},{"path":"/index.html","id":"documentation--tutorials","dir":"","previous_headings":"","what":"Documentation & Tutorials","title":"Distance-preserving Optimiaztion for Spatial Transcriptomics","text":"full reproduction spatial domain identification DLPFC dataset paper, please see DLPFC Vignette.","code":""},{"path":"/reference/DOST.html","id":null,"dir":"Reference","previous_headings":"","what":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","title":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","text":"Runs DOST identify spatial domains spatial transcriptomics data.","code":""},{"path":"/reference/DOST.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","text":"","code":"DOST(   X,   coords,   R,   selected_genes = \"HVG\",   nGenes = 3000,   neighborhood_threshold = 1,   embedding_dim = 20,   lambda = 0.025,   lr = 16,   max_iterations = 20,   refinement = TRUE,   refine_k = 30 )"},{"path":"/reference/DOST.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","text":"X sparse matrix matrix gene expression counts (Genes x Spots). coords data frame matrix spatial coordinates (Spots x 2). Rows coords must match columns X. R Integer. number clusters (domains) identify. selected_genes Character. Gene selection method: \"HVG\" (default), \"SVG\", \"\". nGenes Integer. Number genes use selection enabled. Default 3000. neighborhood_threshold Spatial adjacency threshold multiplier. Default 1. embedding_dim Dimension initial embedding. Default 20. lambda Regularization weight spatial coherence. Default 0.03. lr Optimization learning rate. Default 16. max_iterations Max optimization steps. Default 20. refinement Logical. Whether smooth final labels using spatial neighbors. Recommended tissues laminar structures (e.g., DLPFC, mPFC). Default TRUE. refine_k Number neighbors label refinement. Default 30.","code":""},{"path":"/reference/DOST.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","text":"list containing: Z: low-dimensional embedding matrix. labels: final cluster labels. losses: loss function history.","code":""},{"path":"/reference/DOST.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"DOST: Distance-preserving Optimization for Spatial Transcriptomics — DOST","text":"Recommended Settings Technology: default parameters optimized 10x Visium data. technologies, recommend following adjustments based benchmarks: 10x Visium: embedding_dim = 20 neighborhood_threshold = 1 lambda = 0.03 nGenes = 3000 (HVG SVG) MERFISH: embedding_dim = 10 neighborhood_threshold = 3 (Due higher spatial resolution) lambda = 0.2 selected_genes = \"\" (gene count low) STARmap: embedding_dim = 10 neighborhood_threshold = 1 lambda = 0.15 selected_genes = \"\" Refinement Note: optional refinement step (refinement = TRUE) effectively smooths boundaries highly recommended tissues known laminar layered structures (e.g., Cortex). tissues discrete, punctate domains, may wish set FALSE.","code":""},{"path":"/reference/compute_grad.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute Gradient (Internal C++ function) — compute_grad","title":"Compute Gradient (Internal C++ function) — compute_grad","text":"Compute Gradient (Internal C++ function)","code":""},{"path":"/reference/compute_grad.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute Gradient (Internal C++ function) — compute_grad","text":"","code":"compute_grad(X, D_x, a, b, eps = 1e-20)"},{"path":"/reference/compute_grad.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute Gradient (Internal C++ function) — compute_grad","text":"X Numeric Matrix D_x Numeric Matrix Numeric Matrix b Numeric Matrix eps Double","code":""},{"path":"/reference/compute_grad.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute Gradient (Internal C++ function) — compute_grad","text":"Gradient matrix","code":""}]
